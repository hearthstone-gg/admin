<!doctype html>
<html lang="en">
  <head>
    <title>Hearthstone.gg - Admin</title>
    <script src="https://code.jquery.com/jquery-git2.min.js"></script>
     
    <link rel="stylesheet" href="bower_components/ng-admin/build/ng-admin.min.css">
  </head>
  <body ng-app="myApp">
    <div ui-view></div>
    <script src="bower_components/ng-admin/build/ng-admin.min.js"></script>
    <script type="text/javascript">
    window.__hsggServices = JSON.parse($.ajax({
        type: 'GET',
        url: '/services.json',
        async: false
    }).responseText); 

    var myApp = angular.module('myApp', ['ng-admin']);
    myApp.config(['NgAdminConfigurationProvider', function(NgAdminConfigurationProvider) {
            
            var nga = NgAdminConfigurationProvider;
            // create an admin application
            var admin = nga.application('hs.gg Admin');
            admin.baseApiUrl('http://' + window.__hsggServices.api.domain+'/');

            // entity factory function
            var user = nga.entity('user').identifier(nga.field('_id')).label('Users');
        
             user.creationView().fields([
                nga.field('bnet.name').label('BNET name'),
                nga.field('bnet.id').label('BNET id'), 
            ]);

            user.listView()
                .title('Users').fields([
                    user.creationView().fields(), // reuse fields from another view in another order
                    nga.field('_id').label('id').editable(false),
                    nga.field('updated', 'date').label('updated').format('MM/dd HH:mm').editable(false),
                    nga.field('created', 'date').label('created').format('MM/dd HH:mm').editable(false),
                ])
                .listActions(['show', 'edit', 'delete']);

            user.editionView().fields([
                user.listView().fields(), // reuse fields from another view in another order
                nga.field('bnet.token').label('BNET token'),
                nga.field('token').label('token'),
            ]).title('Edit {{ entry.values["bnet.name"] }}');

            user.showView().fields([
                user.listView().fields(), // reuse fields from another view in another order
                nga.field('token').label('token').editable(false),
                nga.field('bnet.token').label('BNET token').editable(false),
            ]);

           
            admin.addEntity(user);

            // menu factory function
            var menu = nga.menu();
            menu.addChild(nga.menu(user).icon('<span class="glyphicon glyphicon-user"></span>'));
            admin.menu(menu);

            // dashboard factory function
            var dashboard = nga.dashboard();

            
            // more configuation here later
            // ...
            // attach the admin application to the DOM and run it
            nga.configure(admin);    
    }]);
    </script>
  </body>
</html>